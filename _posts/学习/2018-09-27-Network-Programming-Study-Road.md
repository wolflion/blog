---
layout: post  
title: 网络编程之路  
category: 学习    
tags: 网络        
keywords: 网络编程      

description:    
---  

##  缘起

+ 想整理一下网络编程知识
+ 这《TCP/IP网络编程》的读书摘要（笔记），至少前2部分内容是，**只基于Linux啊，win下的不管**。
+ 我在读这本书之前呢，学过《unix/linux系统编程手册》，**简称TLPI**，所以里面有提到的内容，我没有忘记的，就一笔记带过

##  内容

### Part1、开始网络编程

#### chap1、理解网络编程和套接字

##### 1.1、理解网络编程和套接字

+ **接受连接请求**【即服务端】的套接字创建过程
  + 1、调用`socket()`创建套接字
  + 2、调用`bind()`分配IP地址和端口号
  + 3、调用`listen()`转为可接收请求状态
  + 4、调用`accept()`受理连接请求
+ **请求连接**【即客户端】
  + 1、调用`socket()`
  + 2、调用`connect()`

##### 1.2、基于Linux的文件操作

+ **socket会被认为是文件的一种**，直接用I/O操作即可，`open()、close()、write()`
+ **书上提到了`_t`后缀的数据类型**（一般都是typedef声明引起的）

##### lionel注：

+ TLPI的chap56，提到了**流socket**和**数据报sockect**，本章用到的例子是前者。

#### chap2、套接字类型与协议设置

##### 2.1、套接字协议及其数据传输特性

+ 关于协议
  + **对话中使用的通信规则**
+ 协议族（Protocol Family）
  + socket的第1个参数
  + `sys/socket.h`
  + `PF_INET`，ipv4
  + `PF_PACKET`，底层套接字
+ 套接字类型（type）
  + **套接字的数据传输方式**，socket的第2个参数
  + 1、面向连接的套接字（SOCK_STREAM）
    + 传输过程中数据不会消失
    + 按序传输数据
    + 传输的数据不存在数据边界-*lionel，这个其实没太理解*
  + 2、面向消息的套接字（SOCK_DGRAM）
    + 强调快速传输而非传输顺序
    + 39/421
+ 协议的最终选择
  + socket的第3个参数
  + 一般为0，**但 数据传输方式相同，协议不同，需要第3个参数指定**。【同一协议族中存在多个数据传输方式相同的协议】

##### lionel注：

+ `socket()`的3个参数讲解，知识自己盲区，到时试下`man socket`看看

#### chap3、地址族与数据序列

##### 3.1、

##### 3.2、地址信息的表示

##### 3.3、网络字节序与地址变换

##### 3.4、网络地址的初始化与分配

##### lionel注：

+ 没具体看，知识盲区

#### chap4-5、基于TCP的服务端/客户端

##### 4.1、理解TCP和UDP

##### 4.2、实现基于TCP的服务器端/客户端

+ 就是**本章1.1+1.2**，即连上后进行**读写+关闭**

##### 4.3、实现迭代服务器端/客户端

+ *这个要想一下原理，lionel*

##### 5.1、回声客户端的完美表现

##### 5.2、TCP原理

##### lionel注：

+ 要让我**实现迭代服务器端/客户端**，我也不会



### Part3、《UNP》卷1-补充

#### 25、信号驱动式I/O

##### 25.1、概述

+ 信号驱动式I/O是指进程预先告知内核，使得当某个描述符上发生某事时，内核使用信号通知相关进程。【也称为**异步I/O**】

##### 25.2、套接字的信号驱动式I/O

+ 针对一个套接字使用信号驱动式I/O（SIGIO）要求进程执行以下3个步骤：
  + （1）建立SIGIO信号的信号处理函数
  + （2）设置该套接字的属主，通常使用fcntl的`F_SETOWN`命令设置
  + （3）开启该套接字的信号驱动式I/O，通常通过使用fcntl的`F_SETFL`命令打开`O_ASYNC`标志完成
+ 25.2.1、对于UDP套接字的SIGIO信号
+ 25.2.2、对于TCP套接字的SIGIO信号

##### 25.3、使用SIGIO的UDP回射服务器程序

##### 25.4、小结

+ 信号驱动式I/O就是让内核在套接字发生“某事”时使用SIGIO信号通知进程。
  + 对于已连接TCP套接字，可以导致这种通知的条件为数众多，反而使得这个特性几近无用
  + 对于监听TCP套接字，这种通知发生在有一个新连接已准备好接受之时
  + 对于UDP套接字，这种通知意味着或者到达一个数据报，或者到达一个异步错误，这两种情况下我们都调用recvfrom。

#### 30、客户/服务器程序设计范式  646（660/824）

##### 30.1、概述

+ 当开发一个Unix服务器程序时，我们有如下类型的进程控制可供选择：
  + 迭代服务器（iterative server）
  + 并发服务器（concurrent server）
    + 预先派生子进程（preforking）是让服务器在启动阶段调用fork创建一个子进程池。
    + 预先创建进程（prethreading）是让服务器在启动阶段创建一个线程池。
+ 9个范式

##### 30.2、TCP客户程序设计范式

##### 30.3、TCP测试用客户程序

##### 30.4、TCP迭代服务器程序

##### 30.5、TCP并发服务器程序，每个客户一个子进程

##### 30.6、TCP预先派生子进程服务器程序，accept无上锁保护

##### 30.7、TCP预先派生子进程服务器程序，accept使用文件上锁保护

##### 30.8、TCP预先派生子进程服务器程序，accept线程上锁保护

##### 30.9、TCP预先派生子进程服务器程序，传递描述符

##### 30.10、TCP并发服务器程序，每个客户一个线程

##### 30.11、TCP预先创建线程服务器程序，每个线程各自accept

##### 30.12、TCP预先创建线程服务器程序，主线程统一accept

##### 30.13、小结

##  后记

### 备注

+ 